<th:block xmlns:th="http://www.thymeleaf.org"
          xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
          layout:decorate="~{/layouts/layout.html}">

<th:block layout:fragment="content">

<div class="custom-body container-xxl flex-grow-1 container-p-y">

    <!-- ë©”ì‹œì§€ ì¶œë ¥ -->
    <div id="clientMsgHolder" th:if="${msg}" th:data-msg="${msg}"></div>

    <h2>ê±°ë˜ì²˜ / í˜‘ë ¥ì‚¬ ê´€ë¦¬</h2>

    <!-- ===========================================================
         íƒ­ (ê±°ë˜ì²˜ / í˜‘ë ¥ì‚¬)
    ============================================================ -->
    <ul class="nav nav-tabs mb-3" id="clientTabs">
        <li class="nav-item">
            <a class="nav-link"
               th:classappend="${type == null or type == 'CUSTOMER'} ? 'active' : ''"
               th:href="@{/sales/client(type='CUSTOMER')}">
                ê±°ë˜ì²˜
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link"
               th:classappend="${type == 'SUPPLIER'} ? 'active' : ''"
               th:href="@{/sales/client(type='SUPPLIER')}">
                í˜‘ë ¥ì‚¬
            </a>
        </li>
    </ul>


    <!-- ===========================================================
         ê²€ìƒ‰ ì˜ì—­
    ============================================================ -->
    <div class="row align-items-center g-2 mb-3">
        <div class="col-12 col-lg-9">

            <form class="row g-2 align-items-center"
                  th:action="@{/sales/client}"
                  method="get"
                  role="search">

                <!-- hidden: í˜„ì¬ ì„ íƒëœ íƒ­ -->
                <input type="hidden" name="type" th:value="${type}"/>

                <!-- ê±°ë˜ì²˜ëª… ê²€ìƒ‰ -->
                <div class="col-12 col-md-auto">
                    <input class="form-control"
                           id="keyword"
                           name="keyword"
                           type="search"
                           placeholder="ê±°ë˜ì²˜ëª… / ì‚¬ì—…ìë²ˆí˜¸ / ë‹´ë‹¹ìëª… ê²€ìƒ‰"
                           style="width:280px;"
                           th:value="${keyword}">
                </div>

                <div class="col-6 col-md-auto d-grid">
                    <button class="btn btn-outline-primary"
                            id="btnSearch"
                            type="submit">
                        ê²€ìƒ‰
                    </button>
                  </div>

        </form>

    </div>

    <!-- ì‹ ê·œ ê±°ë˜ì²˜ ë“±ë¡ ë²„íŠ¼ : ìš°ì¸¡ ì •ë ¬ -->
    <div class="col-12 col-lg-auto ms-lg-auto d-grid">
        <a class="btn btn-primary w-100"
           th:href="@{/sales/client/create}">
            ë“±ë¡
        </a>
    </div>
</div>

    <!-- ===========================================================
         AG GRID ì˜ì—­
    ============================================================ -->
    <div class="card">
        <div class="card-body">
            <div id="clientGrid"
                 class="ag-theme-quartz"
                 style="height:600px"></div>
        </div>
    </div>

</div>

<!-- ===========================================================
     ğŸ”¥ ì´ˆê¸° ë°ì´í„° ì „ë‹¬ (window ê°ì²´ì— í• ë‹¹)
============================================================ -->
<script th:inline="javascript">
    // window ê°ì²´ì— ëª…ì‹œì ìœ¼ë¡œ í• ë‹¹
    window.initialClientList = /*[[${list}]]*/ [];
    window.currentType = /*[[${type}]]*/ 'CUSTOMER';
    
    // ë””ë²„ê¹…ìš© ë¡œê·¸
    console.log('ğŸ“Œ ì´ˆê¸° ë°ì´í„° ì„¤ì •:', {
        type: window.currentType,
        count: window.initialClientList?.length ?? 0,
        data: window.initialClientList
    });
</script>


<!-- AG Grid v31+ ìµœì‹ ë²„ì „ -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-theme-quartz.css"/>

<!-- 1. AG Grid (ë°˜ë“œì‹œ clientList.js ë³´ë‹¤ ë¨¼ì € ë¡œë“œ) -->
<script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>

<!-- 2. ì»¤ìŠ¤í…€ JS (AG Grid ë¡œë“œ í›„) -->
<script src="/js/sales/clientList.js"></script>


</th:block>
</th:block>