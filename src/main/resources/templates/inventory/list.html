<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layouts/layout}">

<head>
    <title>재고 관리 - 재고 리스트</title>
    <!-- Inventory Specific CSS -->
    <link rel="stylesheet" th:href="@{/css/inventory/inventory.css}" />
    <style type="text/css">
       	#loading-overlay{
    		display: none;
    	}
	    .spinner-border {
		  display: inline-block;
		  width: 2rem;
		  height: 2rem;
		  vertical-align: -0.125em;
		  border: 0.25em solid currentColor;
		  border-right-color: transparent;
		  border-radius: 50%;
		  animation: spinner-border 0.75s linear infinite;
		}
		
		@keyframes spinner-border {
		  to { transform: rotate(360deg); }
		}
		
		.spinner-border.text-primary {
		  color: #0d6efd !important;
		}
	</style>
</head>

<th:block layout:fragment="content">

    <div class="container-xxl flex-grow-1 container-p-y">
        <h3 class="fw-bold py-3 mb-4">재고 목록</h3>
		<!-- 스피너 -->
        <!-- Search Filter -->
        <div class="card mb-4">
            <div class="card-body">
                <form id="searchForm">
                    <div class="row gx-3 gy-2 align-items-center">
                        <div class="col-md-3">
                            <label class="form-label" for="searchLotNo">LOT 번호</label>
                            <input type="text" class="form-control" id="searchLotNo" placeholder="LOT 번호 입력">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" for="searchProdName">상품명</label>
                            <input type="text" class="form-control" id="searchProdName" placeholder="상품명 입력">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label d-block">&nbsp;</label>
                            <button type="button" class="btn btn-outline-primary" id="btnToggleAdvanced">
                                상세 조건 <i class='bx bx-chevron-down'></i>
                            </button>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label d-block">&nbsp;</label>
                            <button type="button" class="btn btn-primary w-100" id="btnSearch">검색</button>
                        </div>
                    </div>

                    <!-- 검색 상세조건 리스트 -->
                    <div id="advancedSearch" class="mt-3" style="display: none;">
                        <hr class="my-3">
                        <div class="row gx-3 gy-2">
                            <div class="col-md-3">
                                <label class="form-label" for="searchCategory">카테고리</label>
                                <select class="form-select" id="searchCategory">
                                    <option value="">전체</option>
                                    <option value="FG">상품</option>
                                    <option value="RAW">원자재</option>
                                    <option value="SUB">부자재</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label" for="searchZone">Zone</label>
                                <select class="form-select" id="searchZone">
                                    <option value="">전체</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label" for="searchRack">Rack</label>
                                <select class="form-select" id="searchRack">
                                    <option value="">전체</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row gx-3 gy-2">
                            <div class="col-md-3">
                                <label class="form-label" for="searchStatus">상태</label>
                                <select class="form-select" id="searchStatus">
                                    <option value="">전체</option>
                                    <option value="NORMAL">정상</option>
                                    <option value="DISPOSAL_WAIT">임박</option>
                                    <option value="DISPOSAL">폐기</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label" for="searchDate">입고일</label>
                                <input type="date" class="form-control" id="searchDate">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label" for="searchExpireDate">유통기한</label>
                                <input type="date" class="form-control" id="searchExpireDate">
                            </div>
                        </div>
                    </div>
                    
                </form>
            </div>
        </div>

        <!-- Grid Container -->
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">재고 목록</h5>
                <div>
                    <button type="button" class="btn btn-primary btn-sm"
                        onclick="location.href='/inventory/stock-take'">
                        <i class='bx bx-clipboard me-1'></i> 재고 실사
                    </button>
                </div>
            </div>
            <div class="card-body">
       	   		<div id="loading-overlay" style="position:absolute; top:0; left:0; width:100%; height:100%; 
				    background:rgba(255,255,255,0.6); 
				    z-index:99; text-align:center; display:flex; 
				    align-items:center; justify-content:center;">
					<div style="margin-top:30vh;">
						<div class="spinner-border text-primary" role="status">
						</div>
						<br>
						<span class="visually">데이터 불러오는 중...</span>
					</div>
				</div>
                <div id="inventoryGrid"></div>
            </div>
        </div>
    </div>

<!-- 모달창 삽입 -->
<th:block th:insert="~{inventory/modal/inventoryDetailModal}"></th:block>
<th:block th:insert="~{inventory/modal/moveStockModal}"></th:block>
<th:block th:insert="~{inventory/modal/adjustQtyModal}"></th:block>
<th:block th:insert="~{inventory/modal/disposalModal}"></th:block>

</th:block>

<th:block layout:fragment="myScript">
    <script th:src="@{/js/inventory/inventoryList.js}"></script>
</th:block>

</html>